import{r as a,u as V,j as e,C as P,L as g,a as T}from"./index-3iRPG9Bu.js";import{C as D,a as C,b as l}from"./index.esm-aB2BTCbt.js";import{C as f,a as c}from"./CRow-BGaT1TWU.js";import{C as G}from"./CCardGroup-DRJ_SA9H.js";import{C as y,a as v}from"./CCardBody-ZnA988Qk.js";import{C as B}from"./CForm-B3srEGj3.js";import{C as b,a as w}from"./CInputGroupText-Dimjd_AA.js";import{c as O}from"./cil-user-Ddrdy7PS.js";import{C as N}from"./CFormInput-BjgXPPX5.js";import{C as $}from"./CFormControlWrapper-DTREpq_c.js";import{c as q}from"./cil-lock-locked-DmxpJbVL.js";const Y=()=>{const[o,S]=a.useState(""),[d,k]=a.useState(""),[E,m]=a.useState(!0),[p,u]=a.useState(!1),[x,t]=a.useState(""),L=V(),h=s=>s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s):!1,I=async s=>{s.preventDefault(),t("");const i=h(o);if(m(i),!!i){u(!0);try{const r=await fetch("https://application-backend-4anj.onrender.com/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,password:d})}),n=await r.json();if(!r.ok)throw new Error(n.error||"Error de autenticaci칩n");localStorage.setItem("authToken",n.token);const F={1:"admin",2:"teacher",3:"student"},j=T(n.token),R=F[j.role_id];console.log("Decoded token:",j),L(`/dashboard/${R}`)}catch(r){t(r.message||"Error de inicio de sesi칩n. Verifica tus credenciales."),console.error("Login error:",r)}finally{u(!1)}}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(D,{children:e.jsx(f,{className:"justify-content-center",children:e.jsx(c,{md:8,children:e.jsxs(G,{children:[e.jsx(y,{className:"p-4",children:e.jsx(v,{children:e.jsxs(B,{onSubmit:I,noValidate:!0,children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),x&&e.jsx("div",{className:"alert alert-danger",role:"alert",children:x}),e.jsxs(b,{className:"mb-3",children:[e.jsx(w,{children:e.jsx(C,{icon:O})}),e.jsx(N,{type:"email",placeholder:"Email",autoComplete:"email",value:o,onChange:s=>{S(s.target.value),m(h(s.target.value)),t("")},invalid:!E}),e.jsx($,{invalid:!0,children:"Por favor ingrese un correo electr칩nico v치lido"})]}),e.jsxs(b,{className:"mb-4",children:[e.jsx(w,{children:e.jsx(C,{icon:q})}),e.jsx(N,{type:"password",placeholder:"Password",autoComplete:"current-password",value:d,onChange:s=>{k(s.target.value),t("")}})]}),e.jsxs(f,{children:[e.jsx(c,{xs:6,children:e.jsx(l,{color:"primary",className:"px-4",type:"submit",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(P,{component:"span",size:"sm","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:"Cargando..."})]}):"Login"})}),e.jsx(c,{xs:6,className:"text-right",children:e.jsx(l,{color:"link",className:"px-0",as:g,to:"/forgot-password",children:"Forgot password?"})})]})]})})}),e.jsx(y,{className:"text-white bg-primary py-5",style:{width:"44%"},children:e.jsx(v,{className:"text-center",children:e.jsxs("div",{children:[e.jsx("h2",{children:"Sign up"}),e.jsx("p",{children:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}),e.jsx(l,{color:"primary",className:"mt-3",active:!0,tabIndex:-1,as:g,to:"/register",children:"Register Now!"})]})})})]})})})})})};export{Y as default};
