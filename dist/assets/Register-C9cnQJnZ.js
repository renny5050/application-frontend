import{r as a,j as e,C as _}from"./index-3iRPG9Bu.js";import{C as te,a as d,b as re}from"./index.esm-aB2BTCbt.js";import{C as ie,a as oe}from"./CRow-BGaT1TWU.js";import{C as ne,a as le}from"./CCardBody-ZnA988Qk.js";import{C as ce}from"./CForm-B3srEGj3.js";import{C as $}from"./CAlert-CS1k0cQ9.js";import{C as t,a as r}from"./CInputGroupText-Dimjd_AA.js";import{c as g}from"./cil-user-Ddrdy7PS.js";import{C as i}from"./CFormInput-BjgXPPX5.js";import{C as o}from"./CFormControlWrapper-DTREpq_c.js";import{c as q}from"./cil-lock-locked-DmxpJbVL.js";import"./CCloseButton-B86-_tbR.js";import"./useForkedRef-DSh7hi_l.js";const we=()=>{const[u,f]=a.useState(""),[p,N]=a.useState(""),[x,b]=a.useState(""),[h,w]=a.useState(""),[n,y]=a.useState(""),[S,V]=a.useState(""),[K,P]=a.useState(!0),[M,E]=a.useState(!0),[Q,I]=a.useState(!0),[W,R]=a.useState(!0),[X,D]=a.useState(!0),[Y,F]=a.useState(!0),[j,L]=a.useState(!1),[k,C]=a.useState(null),[Z,v]=a.useState(!1),T=s=>s.length>=8,m=s=>s.trim()!=="",A=s=>s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s):!1,B=s=>s.length>=6,G=(s,l)=>s===l,ee=async s=>{s.preventDefault();const l=T(u),O=m(p),z=m(x),H=A(h),J=B(n),U=G(n,S);if(P(l),E(O),I(z),R(H),D(J),F(U),l&&O&&z&&H&&J&&U){L(!0),C(null),v(!1);try{const c=await fetch("https://application-backend-4anj.onrender.com/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dni:u,firstName:p,lastName:x,email:h,password:n,role_id:3,status:"active"})});if(!c.ok){const ae=await c.json();throw new Error(ae.message||"Error en el registro")}const se=await c.json();v(!0),console.log("Registro exitoso:",se),f(""),N(""),b(""),w(""),y(""),V("")}catch(c){C(c.message||"Hubo un problema al registrar")}finally{L(!1)}}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(te,{children:e.jsx(ie,{className:"justify-content-center",children:e.jsx(oe,{md:9,lg:7,xl:6,children:e.jsx(ne,{className:"mx-4",children:e.jsx(le,{className:"p-4",children:e.jsxs(ce,{onSubmit:ee,noValidate:!0,children:[e.jsx("h1",{children:"Registro"}),e.jsx("p",{className:"text-body-secondary",children:"Crea tu cuenta"}),j&&e.jsxs("div",{className:"text-center my-3",children:[e.jsx(_,{color:"primary"}),e.jsx("p",{className:"mt-2",children:"Enviando datos..."})]}),Z&&e.jsx($,{color:"success",onClose:()=>v(!1),dismissible:!0,children:"¡Registro exitoso! Revisa tu correo para confirmar la cuenta."}),k&&e.jsx($,{color:"danger",onClose:()=>C(null),dismissible:!0,children:k}),e.jsxs(t,{className:"mb-3",children:[e.jsx(r,{children:e.jsx(d,{icon:g})}),e.jsx(i,{type:"text",placeholder:"DNI",autoComplete:"dni",value:u,onChange:s=>{f(s.target.value),P(T(s.target.value))},invalid:!K}),e.jsx(o,{invalid:!0,children:"El DNI debe tener al menos 8 caracteres"})]}),e.jsxs(t,{className:"mb-3",children:[e.jsx(r,{children:e.jsx(d,{icon:g})}),e.jsx(i,{type:"text",placeholder:"Primer Nombre",autoComplete:"given-name",value:p,onChange:s=>{N(s.target.value),E(m(s.target.value))},invalid:!M}),e.jsx(o,{invalid:!0,children:"Por favor ingrese su primer nombre"})]}),e.jsxs(t,{className:"mb-3",children:[e.jsx(r,{children:e.jsx(d,{icon:g})}),e.jsx(i,{type:"text",placeholder:"Apellido",autoComplete:"family-name",value:x,onChange:s=>{b(s.target.value),I(m(s.target.value))},invalid:!Q}),e.jsx(o,{invalid:!0,children:"Por favor ingrese su apellido"})]}),e.jsxs(t,{className:"mb-3",children:[e.jsx(r,{children:"@"}),e.jsx(i,{type:"email",placeholder:"Email",autoComplete:"email",value:h,onChange:s=>{w(s.target.value),R(A(s.target.value))},invalid:!W}),e.jsx(o,{invalid:!0,children:"Por favor ingrese un correo electrónico válido"})]}),e.jsxs(t,{className:"mb-3",children:[e.jsx(r,{children:e.jsx(d,{icon:q})}),e.jsx(i,{type:"password",placeholder:"Contraseña",autoComplete:"new-password",value:n,onChange:s=>{y(s.target.value),D(B(s.target.value))},invalid:!X}),e.jsx(o,{invalid:!0,children:"La contraseña debe tener al menos 6 caracteres"})]}),e.jsxs(t,{className:"mb-4",children:[e.jsx(r,{children:e.jsx(d,{icon:q})}),e.jsx(i,{type:"password",placeholder:"Repetir Contraseña",autoComplete:"new-password",value:S,onChange:s=>{V(s.target.value),F(G(n,s.target.value))},invalid:!Y}),e.jsx(o,{invalid:!0,children:"Las contraseñas no coinciden"})]}),e.jsx("div",{className:"d-grid",children:e.jsx(re,{color:"success",type:"submit",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(_,{size:"sm"})," Registrando..."]}):"Crear Cuenta"})})]})})})})})})})};export{we as default};
