import{r as t,j as e}from"./index-3iRPG9Bu.js";import{a as n}from"./index.esm-aB2BTCbt.js";import{C as c}from"./CAlert-CS1k0cQ9.js";import{C as x,a as j}from"./CCardBody-ZnA988Qk.js";import{C}from"./CCardHeader-D5Sem3LH.js";import{C as T,a as y}from"./CRow-BGaT1TWU.js";import{c as H}from"./cil-calendar-B69zOQSH.js";import{c as _}from"./cil-user-Ddrdy7PS.js";import"./CCloseButton-B86-_tbR.js";import"./useForkedRef-DSh7hi_l.js";var M=["512 512","<rect width='288' height='32' x='112' y='152' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='288' height='32' x='112' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='152' height='32' x='112' y='328' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M480,48H32V464H480ZM448,432H64V80H448Z' class='ci-primary'/>"],V=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='368 350.643 256 413.643 144 350.643 144 284.081 112 266.303 112 369.357 256 450.357 400 369.357 400 266.303 368 284.081 368 350.643' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M256,45.977,32,162.125v27.734L256,314.3,448,207.637V296h32V162.125ZM416,188.808l-32,17.777L256,277.7,128,206.585,96,188.808,73.821,176.486,256,82.023l182.179,94.463Z' class='ci-primary'/>"];const F=()=>{const[i,g]=t.useState([]),[N,l]=t.useState(!0),[m,d]=t.useState(null),[w,b]=t.useState("Profesor/a"),h=()=>localStorage.getItem("authToken")||"",E=()=>{const r=h();if(!r)return null;try{return JSON.parse(atob(r.split(".")[1]))}catch(s){return console.error("Error decodificando token:",s),null}},u=()=>({"Content-Type":"application/json",Authorization:`Bearer ${h()}`}),p=r=>{if(!r)return"";const[s,o]=r.split(":"),a=new Date;return a.setHours(parseInt(s,10),parseInt(o,10)),a.toLocaleTimeString("es-VE",{hour:"numeric",minute:"2-digit",hour12:!0})},v=async r=>{try{const s=await fetch(`https://application-backend-4anj.onrender.com/api/studentclass/class/${r}`,{headers:u()});return s.ok?(await s.json()).length:(console.warn(`Error obteniendo estudiantes para clase ${r}`),0)}catch(s){return console.error(`Error fetching student count for class ${r}:`,s),0}},k=async()=>{try{const r=E();if(!(r!=null&&r.id))throw new Error("No se pudo obtener el ID del profesor");l(!0),d(null);const s=await fetch(`https://application-backend-4anj.onrender.com/api/classes/teacher/${r.id}`,{headers:u()});if(!s.ok)throw new Error("Error al cargar tus clases");const o=await s.json(),a=await Promise.all(o.map(async f=>{const S=await v(f.id);return{...f,student_count:S}}));g(a),a.length>0&&a[0].teacher_name&&b(a[0].teacher_name)}catch(r){d(r.message||"Error al cargar clases")}finally{l(!1)}};return t.useEffect(()=>{k()},[]),N?e.jsx(c,{color:"info",children:"Cargando información del profesor..."}):m?e.jsx(c,{color:"danger",children:m}):e.jsx("div",{className:"teacher-main-dashboard",children:e.jsxs(x,{className:"mb-4",children:[e.jsxs(C,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-0",children:"Panel del Profesor"}),e.jsxs("small",{className:"text-medium-emphasis",children:["Bienvenida, ",w," - ",new Date().toLocaleDateString("es-VE")]})]}),e.jsx(n,{icon:V,height:36,className:"text-primary"})]}),e.jsxs(j,{children:[e.jsx("h5",{className:"mb-4",children:"Mis Clases Asignadas"}),e.jsx(T,{children:i.length>0?i.map(r=>e.jsx(y,{xs:12,md:6,xl:4,className:"mb-4",children:e.jsxs(x,{className:"h-100 shadow-sm border-start border-primary border-4",children:[e.jsxs(C,{component:"h6",children:[e.jsx(n,{icon:M,className:"me-2"}),r.specialty_name]}),e.jsxs(j,{children:[e.jsxs("p",{className:"d-flex align-items-center mb-3",children:[e.jsx(n,{icon:H,className:"me-2 text-info"}),e.jsx("strong",{children:"Horario:"})," ",r.day,", ",p(r.start_time)," - ",p(r.end_time)]}),e.jsxs("p",{className:"d-flex align-items-center mb-0",children:[e.jsx(n,{icon:_,className:"me-2 text-success"}),e.jsx("strong",{children:"Estudiantes:"})," ",r.student_count??0]})]})]})},r.id)):e.jsx(y,{children:e.jsx(c,{color:"secondary",className:"text-center",children:"Actualmente no tienes clases asignadas."})})})]})]})})};export{F as default};
