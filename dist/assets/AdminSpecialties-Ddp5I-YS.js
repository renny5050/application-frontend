import{r as i,j as e,C as S}from"./index-3iRPG9Bu.js";import{b as h,a as y}from"./index.esm-aB2BTCbt.js";import{C as D,a as z}from"./CCardBody-ZnA988Qk.js";import{C as A}from"./CCardHeader-D5Sem3LH.js";import{c as B}from"./cil-plus-D8mtC-W5.js";import{C as k}from"./CAlert-CS1k0cQ9.js";import{C as M,a as $,b as E,c as w,d as O,e as C,f as F,g as H,h as I,i as L,j as P,k as J,l as R}from"./cil-trash-DC43jLP2.js";import{C as U}from"./CFormInput-BjgXPPX5.js";import"./CCloseButton-B86-_tbR.js";import"./useForkedRef-DSh7hi_l.js";import"./TeacherContent-4OZygDT1.js";import"./cil-sun-Cy5DgvOh.js";import"./cil-user-Ddrdy7PS.js";import"./cil-lock-locked-DmxpJbVL.js";import"./CFormControlWrapper-DTREpq_c.js";const q=({show:j,onClose:x,onSave:g,isEditing:t,currentSpecialty:o,loading:n})=>{const[l,r]=i.useState({name:""}),[d,m]=i.useState("");i.useEffect(()=>{r(t&&o?{name:o.name}:{name:""})},[o,t]);const b=()=>{if(!l.name.trim()){m("El nombre es requerido");return}m(""),g(l)};return e.jsxs(I,{visible:j,onClose:x,children:[e.jsx(L,{children:e.jsx(P,{children:t?"Editar Especialidad":"Nueva Especialidad"})}),e.jsxs(J,{children:[d&&e.jsx(k,{color:"danger",children:d}),e.jsx("div",{className:"mb-3",children:e.jsx(U,{label:"Nombre de la especialidad",value:l.name,onChange:c=>r({...l,name:c.target.value})})})]}),e.jsxs(R,{children:[e.jsx(h,{color:"secondary",onClick:x,disabled:n,children:"Cancelar"}),e.jsx(h,{color:"primary",onClick:b,disabled:n,children:n?e.jsx(S,{size:"sm"}):"Guardar"})]})]})},oe=()=>{const[j,x]=i.useState([]),[g,t]=i.useState(!1),[o,n]=i.useState(null),[l,r]=i.useState(""),[d,m]=i.useState(!1),[b,c]=i.useState(!1),f=localStorage.getItem("authToken"),u=async()=>{m(!0),r("");try{const a=await fetch("https://application-backend-4anj.onrender.com/api/specialties",{headers:{Authorization:`Bearer ${f}`}});if(!a.ok)throw new Error("Error al cargar las especialidades");const s=await a.json();x(s)}catch(a){r(a.message||"Error al obtener las especialidades")}finally{m(!1)}};i.useEffect(()=>{u()},[]);const T=async a=>{c(!0),r("");try{const s=await fetch("https://application-backend-4anj.onrender.com/api/specialties",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify(a)});if(!s.ok){const p=await s.json();throw new Error(p.message||"Error al crear la especialidad")}u(),t(!1)}catch(s){r(s.message)}finally{c(!1)}},N=async a=>{if(o){c(!0),r("");try{const s=await fetch(`https://application-backend-4anj.onrender.com/api/specialties/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify(a)});if(!s.ok){const p=await s.json();throw new Error(p.message||"Error al actualizar la especialidad")}u(),t(!1),n(null)}catch(s){r(s.message)}finally{c(!1)}}},v=async a=>{if(window.confirm("¿Estás seguro de eliminar esta especialidad?"))try{const s=await fetch(`https://application-backend-4anj.onrender.com/api/specialties/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${f}`}});if(!s.ok){const p=await s.json();throw new Error(p.message||"Error al eliminar la especialidad")}u()}catch(s){r(s.message)}};return e.jsxs(D,{children:[e.jsxs(A,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{children:"Especialidades Musicales"}),e.jsxs(h,{color:"primary",onClick:()=>t(!0),disabled:d,children:[e.jsx(y,{icon:B,className:"me-2"}),"Nueva Especialidad"]})]}),e.jsxs(z,{children:[l&&e.jsx(k,{color:"danger",onClose:()=>r(""),dismissible:!0,children:l}),d?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(S,{}),e.jsx("p",{children:"Cargando especialidades..."})]}):e.jsx(e.Fragment,{children:e.jsxs(M,{hover:!0,responsive:!0,children:[e.jsx($,{children:e.jsxs(E,{children:[e.jsx(w,{children:"ID"}),e.jsx(w,{children:"Nombre"}),e.jsx(w,{children:"Acciones"})]})}),e.jsx(O,{children:j.length===0?e.jsx(E,{children:e.jsx(C,{colSpan:"3",className:"text-center py-4",children:"No hay especialidades registradas"})}):j.map(a=>e.jsxs(E,{children:[e.jsx(C,{children:a.id}),e.jsx(C,{children:a.name}),e.jsxs(C,{children:[e.jsx(h,{color:"info",size:"sm",className:"me-2",onClick:()=>{n(a),t(!0)},children:e.jsx(y,{icon:F})}),e.jsx(h,{color:"danger",size:"sm",onClick:()=>v(a.id),children:e.jsx(y,{icon:H})})]})]},a.id))})]})}),e.jsx(q,{show:g,onClose:()=>{t(!1),n(null)},onSave:o?N:T,isEditing:!!o,currentSpecialty:o,loading:b})]})]})};export{oe as default};
